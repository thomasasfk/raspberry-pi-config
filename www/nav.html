<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker Services</title>
    <style>
        body{font-family:system-ui;max-width:800px;margin:40px auto;padding:20px;background:#1a1a1a;color:#fff}
        .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px}
        .card{background:#2d2d2d;padding:20px;border-radius:8px;box-shadow:0 2px 4px #0003;position:relative}
        a{color:#64B5F6;text-decoration:none;display:block;margin:8px 0}
        a:hover{color:#90CAF9}
        .port,.host{color:#b3b3b3;font-size:14px;cursor:pointer}
        .edit{position:absolute;top:8px;right:8px;background:none;border:none;color:#64B5F6;cursor:pointer}
        dialog{background:#2d2d2d;color:#fff;border:1px solid #64B5F6;border-radius:8px;padding:20px}
        input{background:#1a1a1a;border:1px solid #64B5F6;color:#fff;padding:4px;margin:4px 0;width:100%}
        button{background:#64B5F6;color:#1a1a1a;border:none;padding:8px;border-radius:4px;cursor:pointer;margin:4px}
    </style>
</head>
<body>
    <h1 style="text-align:center">Docker Services</h1>
    <button onclick="openAddDialog()" style="margin-bottom:20px">Add Service</button>
    <div class="grid" id="services"></div>

    <dialog id="serviceDialog">
        <h3 id="dialogTitle">Add Service</h3>
        <input id="serviceName" placeholder="Service Name">
        <input id="servicePort" placeholder="Port">
        <input id="serviceDesc" placeholder="Description">
        <input id="serviceHost" placeholder="Host" value="raspberrypi.local">
        <button onclick="saveService()">Save</button>
        <button onclick="serviceDialog.close()">Cancel</button>
        <button onclick="deleteService()" id="deleteBtn" style="background:#ff4444">Delete</button>
    </dialog>

    <script>
        const defaultServices = {
            "Home Assistant": { port: 8000, desc: "Home automation platform", host: "raspberrypi.local" },
            "OctoPrint": { port: 8001, desc: "3D printer management", host: "raspberrypi.local" },
            "Pi-hole": { port: 8003, desc: "Network-wide ad blocking", host: "raspberrypi.local" },
            "ruTorrent": { port: 8005, desc: "Torrent client web interface", host: "raspberrypi.local" },
            "Portainer": { port: 8008, desc: "Docker management UI", host: "raspberrypi.local" }
        };

        let services = JSON.parse(localStorage.getItem('services')) || defaultServices;
        let editingService = '';

        function renderServices() {
            document.getElementById('services').innerHTML = Object.entries(services)
                .map(([name, {port, desc, host}]) => `
                    <div class="card">
                        <button class="edit" onclick="editService('${name}')">✏️</button>
                        <h2>${name}</h2>
                        <div class="host">Host: ${host}</div>
                        <div class="port">Port: ${port}</div>
                        <div style="margin:4px 0">${desc}</div>
                        <a href="http://${host}:${port}">Open ${name}</a>
                    </div>
                `).join('');
        }

        function openAddDialog() {
            editingService = '';
            dialogTitle.textContent = 'Add Service';
            serviceDialog.showModal();
            deleteBtn.style.display = 'none';
            serviceName.value = '';
            servicePort.value = '';
            serviceDesc.value = '';
            serviceHost.value = 'raspberrypi.local';
        }

        function editService(name) {
            editingService = name;
            dialogTitle.textContent = 'Edit Service';
            deleteBtn.style.display = 'block';
            serviceName.value = name;
            servicePort.value = services[name].port;
            serviceDesc.value = services[name].desc;
            serviceHost.value = services[name].host;
            serviceDialog.showModal();
        }

        function saveService() {
            const name = serviceName.value;
            if (editingService && editingService !== name) delete services[editingService];
            services[name] = {
                port: servicePort.value,
                desc: serviceDesc.value,
                host: serviceHost.value
            };
            localStorage.setItem('services', JSON.stringify(services));
            serviceDialog.close();
            renderServices();
        }

        function deleteService() {
            if (editingService) {
                delete services[editingService];
                localStorage.setItem('services', JSON.stringify(services));
                serviceDialog.close();
                renderServices();
            }
        }

        renderServices();
    </script>
</body>
</html>
